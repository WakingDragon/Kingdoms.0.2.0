name: Quick Validation
on:
  workflow_dispatch:
  push:
    branches: [ main, staging-CI ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Basic Unity project validation
        run: |
          echo "üéÆ Kingdoms Unity Project Validation"
          echo "Repository: $GITHUB_REPOSITORY"
          echo "Branch: ${{ github.ref_name }}"
          echo "Commit: ${{ github.sha }}"
          echo ""
          
          # Check Unity project structure
          if [ -f "ProjectSettings/ProjectVersion.txt" ]; then
            echo "‚úÖ Unity project detected"
            echo "Unity Version: $(cat ProjectSettings/ProjectVersion.txt | head -n1)"
          else
            echo "‚ùå Not a Unity project"
            exit 1
          fi
          
          # Check for Assets directory
          if [ -d "Assets" ]; then
            asset_count=$(find Assets -type f -name "*.cs" | wc -l)
            echo "‚úÖ Assets directory found with $asset_count C# scripts"
          else
            echo "‚ùå Assets directory not found"
            exit 1
          fi
          
          # Check packages
          if [ -f "Packages/manifest.json" ]; then
            package_count=$(jq '.dependencies | length' Packages/manifest.json)
            echo "‚úÖ Package manifest found with $package_count dependencies"
          fi
          
          echo "üéâ Basic validation passed!"
